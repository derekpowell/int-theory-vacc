---
title: 'Vaccines: Many Beliefs Study 3: Overparenting deep dive'
author: "Kara Weisman, Derek Powell"
date: "2018-05-18"
output:
  html_notebook:
    toc: true
    toc_float: true
---

```{r, include = F}
knitr::opts_chunk$set(echo = FALSE, message = FALSE)
```

<script type="text/javascript">
  // When the document is fully rendered...
  $(document).ready(function() {
    // ...select all header elements...
    $('h1, h2, h3, h4, h5').each(function() {
      // ...and add an id to them corresponding to their 'titles'
      $(this).attr('id', $(this).html());
    });
  });
</script>

```{r setup, include = F}
library(tidyverse)
library(psych)
library(lme4)
# library(brms)
library(rms)
```

This is a document where we do a "deep dive" on the "Overparenting" scale, which is one of the scales we are least able to predict movement in after the Disease Risk intervention - and a case that we think might be involved meaningful interactions with other scales (e.g., Disease Severity, Medical Skepticism).

```{r tidy, include = F}
# load data
d_all <- read.csv("../data/study2_data.csv")[-1]

# reformat to match previous analyses (i.e., 2 rows per participant)
d_demo <- d_all %>% 
  select(workerId, condition, gender, age, ethnicity, education, job, income,
         political_party, political_beliefs, eligible_pretest, 
         is_parent_posttest, children_num_posttest, children_oldest_posttest, 
         children_youngest_posttest, plan_parent_posttest,
         starts_with("flushot_"), starts_with("vax_"), starts_with("attention_"),
         starts_with("comments"), starts_with("duration"))
d_pre <- d_all %>% 
  select(workerId, ends_with("_pretest")) %>%
  select(-c(eligible_pretest, starts_with("flushot_"), starts_with("vax_"), 
            starts_with("attention_"), starts_with("comments"), 
            starts_with("duration"))) %>%
  rename_all(funs(gsub("_pretest", "", .))) %>%
  mutate(phase = "pre")
d_post <- d_all %>% 
  select(workerId, ends_with("_posttest")) %>%
  select(-c(is_parent_posttest, children_num_posttest, children_oldest_posttest,
            children_youngest_posttest, plan_parent_posttest,
            starts_with("flushot_"), starts_with("vax_"), starts_with("attention_"),
            starts_with("comments"), starts_with("duration"))) %>%
  rename_all(funs(gsub("_posttest", "", .))) %>%
  mutate(phase = "post")

d <- bind_rows(d_pre, d_post) %>% 
  gather(question, response, -c(workerId, phase)) %>%
  mutate(phase = factor(phase,
                        levels = c("pre", "post")),
         reverse_cat = ifelse(grepl("_[1-9]r$", question), TRUE, FALSE),
         # NOTE: "response" has already been reverse coded!
         question = factor(question),
         scale = factor(gsub("_.*$", "", question),
                        levels = c("vaccIntent", "vaccDanger", "vaccEff", 
                                   "vaccStrain", "vaccTox", 
                                   "diseaseSevere", "diseaseRare", 
                                   "infantImmLimCap", "infantImmWeak", 
                                   "medSkept", "hb", "nat", 
                                   "overpar", "parentExpert"))) %>%
  full_join(d_demo) %>%
  mutate(condition = factor(condition, levels = c("noInterv", "diseaseRisk"))) %>%
  filter(!is.na(response), !is.na(workerId), !is.na(condition)) %>%
  distinct()

# how many left?
# d %>% distinct(workerId, condition) %>% count(condition)
```

```{r scores, include = F}
# score all scales
d_scored <- d %>%
  select(workerId, condition, phase, scale, response,
         gender:duration_posttest) %>%
  group_by(workerId, condition, phase, scale) %>%
  mutate(response = as.numeric(response)) %>%
  summarise(mean = mean(response, na.rm = TRUE)) %>%
  ungroup() %>%
  distinct()
```

# Reliability

Let's look at the observed reliability of the Overparenting scale at pre-test:

```{r}
d_pre %>% select(starts_with("overpar_")) %>% alpha()
```

Not spectacular, but there don't appear to be items that would dramatically improve it.

Let's look at the observed reliability of the Overparenting scale at post-test:

```{r}
d_post %>% select(starts_with("overpar_")) %>% alpha()
```

Again, not spectacular, though perhaps slightly better than at pre-test; no obvious items that should be dropped.

It's possible that the lower-than-average reliability for this scale is one of the reasons it's harder to predict - it's the lowest reliability of all 14 scales at both pre- and post-test (though not dramatically lower than the Disease Rarity scale at pre-test, $\alpha$ = 0.75, or the Naturalism scale at post-test, $\alpha$ = 0.76).

```{r, include = F}
d_pre %>% select(starts_with("hb_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("nat_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("medSkept_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("diseaseRare_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("diseaseSevere")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("vaccEff_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("vaccDanger")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("vaccTox_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("vaccStrain_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("vaccIntent_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("parentExpert_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("infantImmLimCap_")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("infantImmWeak")) %>% select(-contains("check")) %>% alpha()
d_pre %>% select(starts_with("overpar_")) %>% select(-contains("check")) %>% alpha()

d_post %>% select(starts_with("hb_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("nat_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("medSkept_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("diseaseRare_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("diseaseSevere")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("vaccEff_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("vaccDanger")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("vaccTox_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("vaccStrain_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("vaccIntent_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("parentExpert_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("infantImmLimCap_")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("infantImmWeak")) %>% select(-contains("check")) %>% alpha()
d_post %>% select(starts_with("overpar_")) %>% select(-contains("check")) %>% alpha()
```


# Distributions of scores

Let's look at the overall distribution of scores on the Overparenting scale, by condition and phase:

```{r, fig.width = 4, fig.asp = 0.67}
d_scored %>%
  filter(scale == "overpar") %>%
  ggplot(aes(x = mean, fill = condition)) +
  facet_grid(phase ~ condition) +
  geom_bar(stat = "count", position = "identity") +
  scale_x_continuous(limits = c(-3, 3), breaks = seq(-100, 100, 1)) +
  theme_minimal() +
  labs(title = "Distribution of Overparenting scores by phase and condition",
       x = "Overparenting score (range: -3 to +3)",
       y = "Number of participants",
       fill = "Condition")

# d_scored %>%
#   filter(scale == "overpar") %>%
#   ggplot(aes(x = phase, color = condition, y = mean)) +
#   facet_grid(~ condition) +
#   geom_point(position = position_jitter(width = 0.4, height = 0), alpha = 0.5) +
#   scale_y_continuous(limits = c(-3, 3), breaks = seq(-100, 100, 1)) +
#   theme_minimal() +
#   theme(legend.position = "none") +
#   labs(title = "Distribution of Overparenting scores by phase and condition",
#        x = "Phase",
#        y = "Overparenting score (range: -3 to +3)", 
#        fill = "Condition")

d_scored %>%
  filter(scale == "overpar") %>%
  group_by(condition, phase) %>%
  do(data.frame(rbind(smean.cl.boot(.$mean)))) %>% # bootstrapped 95% CI
  ggplot(aes(x = phase, y = Mean)) +
  facet_grid(~ condition) +
  geom_point(data = d_scored %>% 
               filter(scale == "overpar") %>% 
               distinct(workerId, condition, phase, mean),
             aes(x = phase, y = mean, color = condition),
             position = position_jitter(width = 0.4, height = 0), 
             alpha = 0.5, size = 0.8) +
  geom_pointrange(aes(ymin = Lower, ymax = Upper)) +
  scale_y_continuous(limits = c(-3, 3), breaks = seq(-100, 100, 1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Distribution of Overparenting scores by phase and condition",
       subtitle = "Error bars are 95% bootstrapped CIs",
       x = "Phase",
       y = "Overparenting score (range: -3 to +3)", 
       fill = "Condition")
```

And at the difference scores:

```{r, fig.width = 4, fig.asp = 0.67}
d_scored %>%
  filter(scale == "overpar") %>%
  spread(phase, mean) %>%
  mutate(diff = post - pre) %>%
  ggplot(aes(x = diff, fill = condition)) +
  facet_grid(~ condition) +
  geom_histogram(binwidth = 0.2) +
  geom_vline(xintercept = 0, lty = 2) +
  scale_x_continuous(breaks = seq(-100, 100, 1)) +
  theme_minimal() +
  labs(title = "Distribution of Overparenting difference scores by condition",
       x = "Difference score",
       y = "Number of participants",
       fill = "Condition")

d_scored %>% 
  filter(scale == "overpar") %>%
  spread(phase, mean) %>%
  mutate(diff = post - pre) %>%
  group_by(condition) %>%
  do(data.frame(rbind(smean.cl.boot(.$diff)))) %>%
  ggplot(aes(x = condition, y = Mean)) +
  geom_point(data = d_scored %>% 
               filter(scale == "overpar") %>%
               spread(phase, mean) %>%
               mutate(diff = post - pre) %>%
               distinct(workerId, condition, diff),
             aes(x = condition, y = diff, color = condition),
             position = position_jitter(width = 0.4, height = 0), 
             alpha = 0.5, size = 0.8) +
  geom_pointrange(aes(ymin = Lower, ymax = Upper)) +
  geom_hline(yintercept = 0, lty = 2) +
  scale_y_continuous(limits = c(-3, 3), breaks = seq(-100, 100, 1)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Distribution of Overparenting difference scores by condition",
       subtitle = "Error bars are 95% bootstrapped CIs (on difference scores)",
       x = "Phase",
       y = "Difference score", 
       fill = "Condition")  
```

Looks like mean scores were around the midpoint (0) at pre-test in both conditions, and increased at post-test among participants in the Disease Risk condition (but not the No Intervention condition). This increase in the Disease Risk condition seems to be on the order of 0.25 pts on our 7-point scale.

# Correlations with other scales

Let's look at the observed correlations between the Overparenting scale and other scales:

```{r, fig.width = 8, fig.asp = 1}
d_scored %>%
  filter(phase == "pre", condition == "noInterv") %>%
  distinct(workerId, scale, mean) %>%
  spread(scale, mean) %>%
  select(-workerId) %>%
  cor() %>%
  data.frame() %>%
  rownames_to_column("scaleA") %>%
  gather(scaleB, noInterv_pre_cor, -scaleA) %>%
  full_join(d_scored %>%
              filter(phase == "post", condition == "noInterv") %>%
              distinct(workerId, scale, mean) %>%
              spread(scale, mean) %>%
              select(-workerId) %>%
              cor() %>%
              data.frame() %>%
              rownames_to_column("scaleA") %>%
              gather(scaleB, noInterv_post_cor, -scaleA)) %>%
  full_join(d_scored %>%
              filter(phase == "pre", condition == "diseaseRisk") %>%
              distinct(workerId, scale, mean) %>%
              spread(scale, mean) %>%
              select(-workerId) %>%
              cor() %>%
              data.frame() %>%
              rownames_to_column("scaleA") %>%
              gather(scaleB, diseaseRisk_pre_cor, -scaleA)) %>%
  full_join(d_scored %>%
              filter(phase == "post", condition == "diseaseRisk") %>%
              distinct(workerId, scale, mean) %>%
              spread(scale, mean) %>%
              select(-workerId) %>%
              cor() %>%
              data.frame() %>%
              rownames_to_column("scaleA") %>%
              gather(scaleB, diseaseRisk_post_cor, -scaleA)) %>%
  gather(group, cor, -c(scaleA, scaleB)) %>%
  mutate(condition = gsub("_.*$", "", group),
         phase = gsub("^.*_p", "p", gsub("_cor", "", group))) %>%
  select(-group) %>%
  mutate(condition = factor(condition, levels = c("noInterv", "diseaseRisk")),
         phase = factor(phase, levels = c("pre", "post"))) %>%
  ggplot(aes(x = scaleA, y = scaleB, fill = cor,
             label = format(round(cor, 2), digits = 2))) +
  facet_grid(phase ~ condition) +
  geom_tile() +
  geom_text() +
  annotate("rect", xmin = 0.5, xmax = 14.5, ymin = 7.5, ymax = 8.5,
           alpha = 0, size = 1, color = "black") +
  annotate("rect", ymin = 0.5, ymax = 14.5, xmin = 7.5, xmax = 8.5,
           alpha = 0, size = 1, color = "black") +
  scale_fill_distiller(palette = "RdYlBu", limits = c(-1, 1),
                       guide = guide_colorbar(barheight = 30)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +
  coord_equal() +
  labs(title = "Correlations between scales, by phase and condition",
       x = "", y = "", fill = "R")
```

```{r, fig.width = 4, fig.asp = 0.67}
d_scored %>%
  filter(phase == "pre", condition == "noInterv") %>%
  distinct(workerId, scale, mean) %>%
  spread(scale, mean) %>%
  select(-workerId) %>%
  cor() %>%
  data.frame() %>%
  rownames_to_column("scaleA") %>%
  gather(scaleB, noInterv_pre_cor, -scaleA) %>%
  full_join(d_scored %>%
              filter(phase == "post", condition == "noInterv") %>%
              distinct(workerId, scale, mean) %>%
              spread(scale, mean) %>%
              select(-workerId) %>%
              cor() %>%
              data.frame() %>%
              rownames_to_column("scaleA") %>%
              gather(scaleB, noInterv_post_cor, -scaleA)) %>%
  full_join(d_scored %>%
              filter(phase == "pre", condition == "diseaseRisk") %>%
              distinct(workerId, scale, mean) %>%
              spread(scale, mean) %>%
              select(-workerId) %>%
              cor() %>%
              data.frame() %>%
              rownames_to_column("scaleA") %>%
              gather(scaleB, diseaseRisk_pre_cor, -scaleA)) %>%
  full_join(d_scored %>%
              filter(phase == "post", condition == "diseaseRisk") %>%
              distinct(workerId, scale, mean) %>%
              spread(scale, mean) %>%
              select(-workerId) %>%
              cor() %>%
              data.frame() %>%
              rownames_to_column("scaleA") %>%
              gather(scaleB, diseaseRisk_post_cor, -scaleA)) %>%
  gather(group, cor, -c(scaleA, scaleB)) %>%
  mutate(condition = gsub("_.*$", "", group),
         phase = gsub("^.*_p", "p", gsub("_cor", "", group)),
         scale_pair = paste(scaleA, scaleB, sep = "_")) %>%
  select(-group) %>%
  mutate(condition = factor(condition, levels = c("noInterv", "diseaseRisk")),
         phase = factor(phase, levels = c("pre", "post"))) %>%
  filter(scaleA == "overpar", scaleB != "overpar") %>%
  ggplot(aes(x = phase, y = cor, color = scale_pair, group = scale_pair)) +
  facet_grid(. ~ condition) +
  geom_line() +
  geom_point() +
  directlabels::geom_dl(aes(label = scale_pair),
                        method = list("last.qp")) + #, cex = 0.8)) +
  theme_minimal() +
  theme(legend.position = "none") +
  labs(title = "Changes in correlations between scales, by condition",
       x = "Phase", y = "R", color = "Pair of scales")
```

At pre-test, none of the other scales was strongy correlated with Overparenting among participants in either condition; the strongest were the two infant immune system beliefs scales (IIS: Limited Capacity and IIS: Weak). 

In the No Intevention condition, these correlations seem to have increased at post-test relative to pre-test; this didn't happen in the Disease Risk condition. The correlation between Overparenting and Medical Skepticism also seems to have increased in this condition from pre- to post-test in the No Intervention condition.

In the Disease Risk condition, a handful of correlations seem to have *decreased* from pre- to post-test, most notably all the correlations with vaccine beliefs, as well as the correlation with Medical Skepticism. Meanwhile, a different set of correlations seem to have *increased* from pre- to post-test, including correlations with Disease Severity (the target of the intervention), Vaccine Intention (the outcome of interest), and Vaccine Efficacy.

So it seems like just filling out these scales twice might have made participants align their beliefs about infant immune systems with their attitudes toward protective parenting (at least in the No Intervention condition) - but in addition to this, the intervention might have changed the relationship between participants' beliefs about vaccines and their attitudes toward protective partenting. In particular, at pre-test, participants who more strongly endorsed what we're calling "overparenting" also tended to think vaccines were more dangerous, less effective, more of a strain on the infant immune system, and more likely to contain toxins, and were generally lower on our Vaccine Intent scale. But at post-test, these relationships no longer held - all of these correlations were pretty close to 0.

(Note that this way of thinking about things is at odds with our use of the same cognitive model connecting all of these beliefs - I need to think harder about this.) 

# Quantile splits

Let's split people into groups by their scores on the Overparenting, Medical Skepticism, and Disease Severity scores, since these were possible interactions that we identified in person. (Note that we could also use our investigations of the changing correlations among scales to do further investigations like this...)

```{r, include = F}
split <- d_scored %>%
  filter(scale %in% c("overpar", "medSkept", "diseaseSevere"), phase == "pre") %>%
  group_by(scale) %>%
  mutate(split = ntile(mean, 3),
         split = factor(split, labels = c("low", "mid", "high"))) %>%
  ungroup() %>%
  select(workerId, condition, scale, split) %>%
  spread(scale, split) %>%
  full_join(d_scored %>% 
              filter(scale == "vaccIntent") %>% 
              distinct(workerId, phase, mean)) %>%
  mutate(overpar = factor(paste("Overparenting:", 
                                as.character(overpar)),
                          levels = c("Overparenting: low",
                                     "Overparenting: mid",
                                     "Overparenting: high")),
         diseaseSevere = factor(paste("Disease Severity:", 
                                      as.character(diseaseSevere)),
                                levels = c("Disease Severity: low",
                                           "Disease Severity: mid",
                                           "Disease Severity: high")),
         medSkept = factor(paste("Medical Skepticism:",
                                 as.character(medSkept)),
                           levels = c("Medical Skepticism: low",
                                      "Medical Skepticism: mid",
                                      "Medical Skepticism: high"))) %>%
  spread(phase, mean) %>%
  mutate(diff = post - pre)
```

## Overparenting and Disease Severity

```{r, fig.width = 4, fig.asp = 1}
split %>%
  group_by(condition, overpar, diseaseSevere) %>%
  do(data.frame(rbind(smean.cl.boot(.$diff)))) %>% # bootstrapped 95% CI
  ggplot(aes(x = condition, y = Mean, color = condition)) +
  # facet_grid(overpar ~ diseaseSevere ~ medSkept) +
  facet_grid(diseaseSevere ~ overpar) +
  geom_hline(yintercept = 0, lty = 2) +
  geom_point(data = split, aes(y = diff),
             alpha = 0.5, position = position_jitter(width = 0.4, height = 0)) +
  geom_pointrange(aes(ymin = Lower, ymax = Upper), color = "black") +
  theme_minimal() +
  theme(legend.position = "none",
        panel.border = element_rect(fill = NA, color = "black")) +
  labs(title = "Changes in Vaccine Intentions",
       subtitle = "By condition, Overparenting quantile at pre-test, and Disease Severity quantile at pre-test\nError bars are 95% bootstrapped CIs",
       x = "Condition", y = "Vaccine Intentions difference score", 
       color = "Condition")
```

What I had written down in our notes from our meeting on 2018-05-15 was that the Disease Risk intervention might be most effective for participants who were high in Overparenting and low or moderate on Disease Severity. This does seem to be the case - these are the top and middle rows for the right-most column. 

Interestingly, this plot reveals that the intervention generally didn't work for participants who started out as low in Overparenting (left-most column) - this is good to know... not sure yet what to make of it! 

As we'd predict, the intervention didn't do much for participants who started out as high in Disease Severity (bottom row).

## Overparenting and Medical Skepticism

```{r, fig.width = 4, fig.asp = 1}
split %>%
  group_by(condition, overpar, medSkept) %>%
  do(data.frame(rbind(smean.cl.boot(.$diff)))) %>% # bootstrapped 95% CI
  ggplot(aes(x = condition, y = Mean, color = condition)) +
  # facet_grid(overpar ~ diseaseSevere ~ medSkept) +
  facet_grid(medSkept ~ overpar) +
  geom_hline(yintercept = 0, lty = 2) +
  geom_point(data = split, aes(y = diff),
             alpha = 0.5, position = position_jitter(width = 0.4, height = 0)) +
  geom_pointrange(aes(ymin = Lower, ymax = Upper), color = "black") +
  theme_minimal() +
  theme(legend.position = "none",
        panel.border = element_rect(fill = NA, color = "black")) +
  labs(title = "Changes in Vaccine Intentions",
       subtitle = "By condition, Overparenting quantile at pre-test, and Medical Skepticism quantile at pre-test\nError bars are 95% bootstrapped CIs",
       x = "Condition", y = "Vaccine Intentions difference score", 
       color = "Condition")
```

I also had written down in our notes that the Disease Risk intervention might be most effective for participants who were high in Overparenting and high in Medicial Skepticism. Again, this does seem to be the case - this would be the bottom right panel.

Note, however, that this might just be a main effect of Medical Skepticism: Participants who started out high in Medical Skepticism (bottom row) seem to have been particularly sensitive to the intervention, perhaps regardless of their Overparenting scores.

Interestingly, this plot reveals that the intervention generally didn't work for participants who started out as low in Medical Skepticism (top row) - again, this is good to know, though again not sure yet what to make of it! 

# Modeling interactions via regression

Let's model these potential interactions via regression. (Again, we could also do this for any of the additional relationships of interest revealed by the changes in correlations, above).

I started off with my go-to model of the intervention, `score ~ phase * condition + (1|subject)` (with phase and condition effect-coded), because it's the one that always makes sense to me, but we should consider doing this with other models as well.

On the idea that we were interested in possible interactions involving Overparenting, Medicial Skepticism, and Disease Severity in particular, I created a new dataframe with pre-test scores for Overparenting, Medicial Skepticism, and Disease Severity (all mean-centered and standardized), and both pre- and post-test scores for Vaccine Intentions (also mean-centered and standardized). I think proceeded through a series of models of increasing complexity (though I know this isn't a very sophisticated approach) - see the code for everything I did.

Somewhat surprisingly, the "best-fitting" model according to model comparison is the one with all of the interactions (I've marked parameters with $t$ > 2 with an asterisk in the table below):

```{r, include = F}
d_scored_wide <- d_scored %>%
  filter(scale == "vaccIntent") %>%
  mutate_at(vars(mean), funs(scale(., scale = T))) %>% 
  spread(scale, mean) %>%
  full_join(d_scored %>%
              filter(phase == "pre", scale != "vaccIntent") %>%
              distinct(workerId, scale, mean) %>%
              group_by(scale) %>%
              mutate_at(vars(mean), funs(scale(., scale = T))) %>% # mean-center & standardize
              spread(scale, mean) %>%
              ungroup())

contrasts(d_scored_wide$phase) <- cbind(post = c(-1, 1))
contrasts(d_scored_wide$condition) <- cbind(DR = c(-1, 1))

r1 <- lmer(vaccIntent ~ phase * condition + (1|workerId), d_scored_wide)
# summary(r1)

r2a <- lmer(vaccIntent ~ phase * condition * overpar + 
              (1|workerId), d_scored_wide)
# summary(r2a)

r2b <- lmer(vaccIntent ~ phase * condition * medSkept + 
              (1|workerId), d_scored_wide)
# summary(r2b)

r2c <- lmer(vaccIntent ~ phase * condition * diseaseSevere + 
              (1|workerId), d_scored_wide)
# summary(r2c)

r3a <- lmer(vaccIntent ~ phase * condition * overpar * medSkept + 
              (1|workerId), d_scored_wide)
# summary(r3a)

r3b <- lmer(vaccIntent ~ phase * condition * overpar * diseaseSevere + 
              (1|workerId), d_scored_wide)
# summary(r3b)

r4 <- lmer(vaccIntent ~ phase * condition * overpar * medSkept * diseaseSevere + 
              (1|workerId), d_scored_wide)
# summary(r4)

anova(r1, r2a, r3a, r4)
anova(r1, r2a, r3b, r4)
```

```{r, as.is = T}
summary(r4)$coefficients %>%
  data.frame() %>%
  rownames_to_column("Parameter") %>%
  mutate(` ` = ifelse(abs(t.value) >= 2, "*", "")) %>%
  knitr::kable(digits = 2)
```

I think the most interesting "significant" parameter here is:

- __`phasepost:conditionDR:overpar:medSkept`: A 4-way interaction betwen phase, condition, Overparenting at pre-test, and Medicial Skepticism at pre-test__. Without thinking too deeply about this yet, I think this means that the intervention effect (the interaction between phase and condition) depended on pre-test scores for Overparenting and Medicial Skepticism. This is consistent with the observations we made looking at the second set of quantile splits, <a href="#Overparenting and Medical Skepticism">above</a>.

Also interesting to think about (later):

- `conditionDR:medSkept:diseaseSevere`: A 3-way interaction between condition, Medical Skepticism at pre-test, and Disease Severity at pre-test.
- `conditionDR:overpar:medSkept:diseaseSevere`: A 4-way interaction between condition, Overparenting at pre-test, Medicial Skepticism at pre-test, and Disease Severity at pre-test.


# Take-aways

This all suggests to me that it would be worth it to try including a node for the interaction between Overparenting and Medical Skepticism (and perhaps a node for the interaction between Overparenting and Disease Severity) in our cognitive model. We've come up with many (post-hoc) reasons why this might be important, and our data suggest that it was.